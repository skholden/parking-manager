<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parking Manager - Modern UI</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tesseract.js/4.1.1/tesseract.min.js"></script>
    <link rel="stylesheet" href="css/modern-styles.css">
</head>
<body>
    <div class="app-container">
        <div class="main-card">
            <!-- Mode Selection Screen -->
            <div id="modeSelector" class="mode-selector">
                <h1 class="app-title">Parking Manager</h1>
                <p class="app-subtitle">Smart license plate recognition system</p>
                
                <div class="mode-grid">
                    <div class="mode-card" onclick="selectMode('customer')">
                        <span class="mode-icon">💳</span>
                        <div class="mode-title">Pay Parking</div>
                        <div class="mode-description">Scan & pay for parking</div>
                    </div>
                    <div class="mode-card" onclick="selectMode('attendant')">
                        <span class="mode-icon">👮‍♀️</span>
                        <div class="mode-title">Verify Payments</div>
                        <div class="mode-description">Check payment status</div>
                    </div>
                </div>
                
                <div style="text-align: center; opacity: 0.7; font-size: 0.875rem;">
                    Choose your role to continue
                </div>
            </div>

            <!-- Customer Interface -->
            <div id="customerInterface" class="interface-card">
                <button class="btn btn-secondary" onclick="goBack()" style="margin-bottom: 1.5rem;">
                    ← Back to Menu
                </button>
                
                <div class="interface-header">
                    <h2 class="interface-title">💳 Pay for Parking</h2>
                    <p class="interface-subtitle">Scan your license plate or enter it manually</p>
                </div>
                
                <div class="country-selector">
                    <label class="country-label" for="customerCountry">License Plate Format</label>
                    <select id="customerCountry" class="country-select">
                        <option value="UK" selected>🇬🇧 United Kingdom</option>
                        <option value="US">🇺🇸 United States</option>
                        <option value="DE">🇩🇪 Germany</option>
                        <option value="FR">🇫🇷 France</option>
                        <option value="ES">🇪🇸 Spain</option>
                        <option value="IT">🇮🇹 Italy</option>
                        <option value="NL">🇳🇱 Netherlands</option>
                        <option value="AU">🇦🇺 Australia</option>
                        <option value="CA">🇨🇦 Canada</option>
                        <option value="JP">🇯🇵 Japan</option>
                    </select>
                </div>
                
                <div class="camera-section">
                    <video id="customerVideo" class="camera-video" autoplay playsinline></video>
                    <canvas id="customerCanvas" class="camera-canvas"></canvas>
                </div>
                
                <div class="button-grid">
                    <button id="startCustomerCamera" class="btn btn-secondary">
                        📹 Start Camera
                    </button>
                    <button id="scanCustomerPlate" class="btn btn-primary" disabled>
                        🔍 Scan Plate
                    </button>
                    <button id="manualCustomerInput" class="btn btn-secondary">
                        ✏️ Enter Manually
                    </button>
                </div>
                
                <div id="customerStatus" class="status-container"></div>
                
                <div id="customerResult" class="result-section" style="display: none;">
                    <h3 style="text-align: center; margin-bottom: 1rem; color: white;">Your License Plate</h3>
                    <div id="customerPlateText" class="license-plate-display"></div>
                    
                    <div class="payment-section">
                        <h4 class="payment-title">Select Parking Duration</h4>
                        <div class="payment-grid">
                            <div class="payment-option" data-hours="1" data-cost="2.00">
                                <div class="payment-duration">1 Hour</div>
                                <div class="payment-cost">$2.00</div>
                            </div>
                            <div class="payment-option" data-hours="2" data-cost="3.50">
                                <div class="payment-duration">2 Hours</div>
                                <div class="payment-cost">$3.50</div>
                            </div>
                            <div class="payment-option" data-hours="4" data-cost="6.00">
                                <div class="payment-duration">4 Hours</div>
                                <div class="payment-cost">$6.00</div>
                            </div>
                            <div class="payment-option" data-hours="8" data-cost="10.00">
                                <div class="payment-duration">All Day</div>
                                <div class="payment-cost">$10.00</div>
                            </div>
                        </div>
                        <button class="btn btn-success" id="payBtn" disabled style="width: 100%; padding: 1rem;">
                            Select Duration to Pay
                        </button>
                    </div>
                </div>
            </div>

            <!-- Attendant Interface -->
            <div id="attendantInterface" class="interface-card">
                <button class="btn btn-secondary" onclick="goBack()" style="margin-bottom: 1.5rem;">
                    ← Back to Menu
                </button>
                
                <div class="interface-header">
                    <h2 class="interface-title">👮‍♀️ Verify Payments</h2>
                    <p class="interface-subtitle">Quick scan to check parking payments</p>
                </div>
                
                <div class="country-selector">
                    <label class="country-label" for="attendantCountry">License Plate Format</label>
                    <select id="attendantCountry" class="country-select">
                        <option value="UK" selected>🇬🇧 United Kingdom</option>
                        <option value="US">🇺🇸 United States</option>
                        <option value="DE">🇩🇪 Germany</option>
                        <option value="FR">🇫🇷 France</option>
                        <option value="ES">🇪🇸 Spain</option>
                        <option value="IT">🇮🇹 Italy</option>
                        <option value="NL">🇳🇱 Netherlands</option>
                        <option value="AU">🇦🇺 Australia</option>
                        <option value="CA">🇨🇦 Canada</option>
                        <option value="JP">🇯🇵 Japan</option>
                    </select>
                </div>
                
                <div class="camera-section">
                    <video id="attendantVideo" class="camera-video" autoplay playsinline></video>
                    <canvas id="attendantCanvas" class="camera-canvas"></canvas>
                </div>
                
                <div class="button-grid">
                    <button id="startAttendantCamera" class="btn btn-secondary">
                        📹 Start Camera
                    </button>
                    <button id="scanAttendantPlate" class="btn btn-primary" disabled>
                        🔍 Quick Scan
                    </button>
                    <button id="manualAttendantInput" class="btn btn-secondary">
                        ✏️ Manual Check
                    </button>
                    <button id="clearAttendantList" class="btn btn-secondary">
                        🗑️ Clear List
                    </button>
                </div>
                
                <div id="attendantStatus" class="status-container"></div>
                
                <!-- Stats Panel -->
                <div class="stats-panel" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin: 1.5rem 0; padding: 1.5rem; background: rgba(255, 255, 255, 0.05); border-radius: 1rem; border: 1px solid rgba(255, 255, 255, 0.1);">
                    <div style="text-align: center;">
                        <div id="totalScanned" style="font-size: 1.5rem; font-weight: 700; color: white;">0</div>
                        <div style="font-size: 0.75rem; color: rgba(255, 255, 255, 0.7); text-transform: uppercase; letter-spacing: 0.05em;">Scanned</div>
                    </div>
                    <div style="text-align: center;">
                        <div id="totalPaid" style="font-size: 1.5rem; font-weight: 700; color: #22c55e;">0</div>
                        <div style="font-size: 0.75rem; color: rgba(255, 255, 255, 0.7); text-transform: uppercase; letter-spacing: 0.05em;">Paid</div>
                    </div>
                    <div style="text-align: center;">
                        <div id="totalUnpaid" style="font-size: 1.5rem; font-weight: 700; color: #ef4444;">0</div>
                        <div style="font-size: 0.75rem; color: rgba(255, 255, 255, 0.7); text-transform: uppercase; letter-spacing: 0.05em;">Unpaid</div>
                    </div>
                </div>
                
                <div id="scanList" class="scan-list"></div>
            </div>
        </div>
    </div>

    <!-- Modern Manual Input Modal -->
    <div id="manualInputModal" class="modal" style="display: none;">
        <div class="modal-content">
            <h3 class="modal-title">Enter License Plate</h3>
            <p class="modal-subtitle">If scanning doesn't work, enter your license plate manually</p>
            
            <div class="input-group">
                <input type="text" 
                       id="manualPlateInput" 
                       class="input-field"
                       placeholder="e.g., AB12 CDE"
                       autocomplete="off"
                       spellcheck="false">
            </div>
            
            <div class="format-examples">
                <p class="examples-title">Common Formats</p>
                <div class="examples-grid">
                    <span class="format-example">AB12 CDE</span>
                    <span class="format-example">A123 BCD</span>
                    <span class="format-example">ABC 123D</span>
                    <span class="format-example">ABC 123</span>
                </div>
            </div>
            
            <div style="display: flex; gap: 0.75rem;">
                <button id="cancelManualInput" class="btn btn-secondary" style="flex: 1;">
                    Cancel
                </button>
                <button id="confirmManualInput" class="btn btn-primary" style="flex: 1;" disabled>
                    Confirm
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/api.js"></script>
    <script src="js/plate-detector.js"></script>
    <script src="js/image-processor.js"></script>
    <script src="js/modern-app.js"></script>
</body>
</html>